{% extends "layout.html" %}

{% block title %}{{ promise.description }} - Promise Tracker{% endblock %}

{% block content %}
<div class="promise-detail-container">
    <div class="breadcrumb">
        <a href="/promises">&larr; ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤</a>
    </div>

    <div class="promise-header-card status-{{ promise.status.name.lower() }}">
        <div class="status-badge-large {{ promise.status.name.lower() }}">{{ promise.status.value }}</div>
        <h1>{{ promise.description }}</h1>
        <p class="announced-date">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏°‡∏∑‡πà‡∏≠: {{ promise.announced_date.strftime('%d/%m/%Y') }}</p>
    </div>

    <div class="content-grid">
        <div class="main-column">
            <section class="updates-section">
                <div class="section-header">
                    <h2>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</h2>
                    {% if request.session.get("role") == "admin" and promise.status.value != "‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏´‡∏≤‡∏¢" %}
                    <a href="/promises/{{ promise.id }}/update" class="btn-primary">
                        üìù ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
                    </a>
                    {% endif %}
                </div>

                {% if promise.updates %}
                <div class="updates-timeline">
                    {% for update in promise.updates|sort(attribute='update_date', reverse=True) %}
                    <div class="update-card">
                        <div class="update-date">{{ update.update_date.strftime('%d/%m/%Y') }}</div>
                        <div class="update-content">
                            <p>{{ update.detail }}</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="empty-state">
                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</p>
                </div>
                {% endif %}
            </section>
        </div>

        <div class="sidebar-column">
            <section class="politician-card">
                <h3>‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤</h3>
                <div class="politician-info">
                    <div class="avatar-placeholder">
                        {{ promise.politician.name[0] }}
                    </div>
                    <div>
                        <h4><a href="/politicians/{{ promise.politician.id }}">{{ promise.politician.name }}</a></h4>
                        <p class="party">{{ promise.politician.party }}</p>
                    </div>
                </div>
            </section>

            <section class="campaign-card">
                <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á</h3>
                <ul>
                    <li><strong>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á:</strong> {{ promise.campaign.year }}</li>
                    <li><strong>‡πÄ‡∏Ç‡∏ï:</strong> {{ promise.campaign.district }}</li>
                    <li><strong>‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤:</strong> {{ promise.id }}</li>
                </ul>
            </section>
        </div>
    </div>
</div>
{% endblock %}